!function(a){"use strict";function b(){g=a(document.body),c()}function c(){g.on("edd_quantity_updated",d),g.on("change",".yst-edd-pricing-switcher",e),g.on("edd_cart_billing_address_updated",f),a("#edd_first").focus()}function d(a,b){EDD_Checkout.recalculate_taxes()}function e(b){var c=a(b.currentTarget),d=c.data("download-id"),e=c.val(),f={action:"yst_update_variation",download_id:d,price_id:e};a.ajax({type:"POST",data:f,dataType:"json",url:edd_global_vars.ajaxurl,xhrFields:{withCredentials:!0}}).success(function(a){"success"===a.status&&EDD_Checkout.recalculate_taxes()})}function f(b,c){"nostates"===c?a("#edd-card-state-wrap").hide():a("#edd-card-state-wrap").show()}var g;a(b)}(jQuery),function(a){function b(a){return void EDD_Checkout.recalculate_taxes()}function c(c,d){jQuery.post(yoast_com_checkout_vars.ajaxurl,{action:"yst_check_vat",country:c,vat_nr:d},function(c){a("#vaterror").remove(),"1"==c?(a("#yst_btw").removeClass("error").addClass("valid"),b(!0),f=!0):"2"==c?(a("#yst_btw").removeClass("valid").addClass("error"),b(),jQuery("#yst-edd-btw-wrap").append('<span id="vaterror" class="error">We cannot check if your VAT number is correct because the VAT checking system for the EU is currently down. We\'re sorry for the inconvenience. Please send us an email on <a href="mailto:support@yoast.com">support@yoast.com</a> or try again later.</span>'),f=!1):(a("#yst_btw").removeClass("valid").addClass("error"),b(),jQuery("#yst-edd-btw-wrap").append('<span id="vaterror" class="error">We cannot verify this VAT number, this means you will have to pay VAT. Please make sure you\'ve entered the number correctly.</span>'),f=!1)})}function d(a){return Math.round(100*a)/100}function e(b,c){var e=c.response;f&&0!==e.tax_rate_raw&&(e.total_raw=e.total_raw-parseFloat(e.tax_raw),e.tax_raw=0,e.tax_rate_raw=0,e.tax_rate="0%",e.total="$ "+d(e.total_raw),e.tax="$"+d(e.tax_raw),a(".edd_cart_amount").html(e.total),a(".yst-tax-rate").html(e.tax_rate.replace("%","")),a(".edd_cart_tax_amount").html(e.tax)),a("#yst_secondary_tax_rate").html(e.tax_rate.replace("%","")),a("#yst_secondary_tax").html(e.tax)}var f=!1;jQuery(document).ready(function(a){var b=a("body");b.on("edd_taxes_recalculated",e),a("#card_number").payment("formatCardNumber"),a("#card-cvc").payment("formatCardCVC"),a(".chosen-select").chosen(),b.on("edd_cart_billing_address_updated",function(){a("#edd-card-state-wrap .chosen-container").remove(),a('select[name="card_state"]').chosen()}),a("#card_number").payment("formatCardNumber");a("#card_number").on("input",function(){a.payment.validateCardNumber(a(this).val())?a(this).removeClass("error").addClass("valid"):a(this).removeClass("valid").addClass("error"),""!=a("#card_cvc").val()&&(a.payment.validateCardCVC(a("#card_cvc").val(),a.payment.cardType(a(this).val()))?a("#card_cvc").removeClass("error").addClass("valid"):a("#card_cvc").removeClass("valid").addClass("error"))}),a("#card_cvc").on("input",function(){a.payment.validateCardCVC(a(this).val(),a.payment.cardType(a("#card_number").val()))?a(this).removeClass("error").addClass("valid"):a(this).removeClass("valid").addClass("error")}),a("#card_exp_year").on("input",function(){var b=a("#card_exp_month").val(),c=a(this).val();""!=b&&(a.payment.validateCardExpiry(b,c)?a("edd-input-cvc").removeClass("error").addClass("valid"):a("edd-input-cvc").removeClass("valid").addClass("error"))}),a("#edd_purchase_form").validate({unhighlight:function(b,c,d,e){"radio"===b.type?this.findByName(b.name).removeClass(c).addClass(d):a(b).hasClass("ignore")?a(b).removeClass(c).removeClass(d):a(b).removeClass(c).addClass(d)},errorClass:"error error-message",rules:{edd_email:{required:!0,email:!0},edd_first:"required",card_name:"required",card_address:{required:!0,minlength:2},card_city:{required:!0,minlength:2},card_zip:{required:!0,minlength:2},billing_country:"required",card_state:"required",edd_agree_to_terms:"required"},messages:{edd_first:"Please enter your first name",edd_email:"Please enter a valid email address",edd_agree_to_terms:"<strong>Error</strong> - Please accept our terms: ",card_name:"Please enter the name on your credit card",card_address:"Please enter the billing address of your credit card",card_zip:"Please enter the zip / postal code of the billing address of your credit card",card_state:"Please enter your state",card_city:"Please enter the city of the billing address of your credit card",billing_country:"Please enter the country of the billing address of your credit card"}}),a("body").on("change","#yst_btw, #billing_country",function(){var b=a("#billing_country").val();if("NL"==b)return a("#yst-edd-btw-wrap").hide().after('<p id="yst-dutch-vat-notice"><strong>Please note:</strong> VAT will be added to the invoice. Since Yoast is based in the Netherlands we cannot reverse charge the VAT.</p>'),void a(".edd_cart_tax_row").css("display","table-row");if(a("#yst-dutch-vat-notice").remove(),void 0==yoast_com_checkout_vars.tax_rates[b])return a("#yst-edd-btw-wrap").hide(),void a(".edd_cart_tax_row").css("display","none");a(".edd_cart_tax_row").css("display","table-row"),a("#yst-edd-btw-wrap").show();var d=a("#yst_btw").val();""!=d&&c(b,d)})})}(jQuery);