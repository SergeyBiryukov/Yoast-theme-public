!function(a){"use strict";function b(){g=a(document.body),c()}function c(){g.on("edd_quantity_updated",d),g.on("change",".yst-edd-pricing-switcher",e),g.on("edd_cart_billing_address_updated",f),a("#edd_first").focus()}function d(a,b){EDD_Checkout.recalculate_taxes()}function e(b){var c=a(b.currentTarget),d=c.data("download-id"),e=c.val(),f={action:"yst_update_variation",download_id:d,price_id:e};a.ajax({type:"POST",data:f,dataType:"json",url:edd_global_vars.ajaxurl,xhrFields:{withCredentials:!0}}).success(function(a){"success"===a.status&&EDD_Checkout.recalculate_taxes()})}function f(b,c){"nostates"===c?a("#edd-card-state-wrap").hide():a("#edd-card-state-wrap").show()}var g;a(b)}(jQuery),function(a){function b(b){void 0==b&&(b=!1);var c=a("#edd_cc_address"),d={action:"yst_edd_recalculate_taxes",nonce:yoast_com_checkout_vars.checkout_nonce,billing_country:c.find("#billing_country").val(),btw_verlegd:b};a.ajax({type:"POST",data:d,dataType:"json",url:yoast_com_checkout_vars.ajaxurl,success:function(b){a("#edd_checkout_cart_div").replaceWith(b.html),a(".edd_cart_amount").html(b.total),a("#yst_secondary_tax").html(a("#yst_main_tax").html()),a("#yst_secondary_tax_rate").html(a("#yst_main_tax_rate").html());var c=new Object;c.postdata=d,c.response=b,a("body").trigger("edd_taxes_recalculated",[c])}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}function c(c,e){jQuery.post(yoast_com_checkout_vars.ajaxurl,{action:"yst_check_vat",country:c,vat_nr:e},function(c){a("#vaterror").remove(),"1"==c?(a("#yst_btw").removeClass("error").addClass("valid"),b(!0),d=!0):"2"==c?(a("#yst_btw").removeClass("valid").addClass("error"),b(),jQuery("#yst-edd-btw-wrap").append('<span id="vaterror" class="error">We cannot check if your VAT number is correct because the VAT checking system for the EU is currently down. We\'re sorry for the inconvenience. Please send us an email on <a href="mailto:support@yoast.com">support@yoast.com</a> or try again later.</span>'),d=!1):(a("#yst_btw").removeClass("valid").addClass("error"),b(),jQuery("#yst-edd-btw-wrap").append('<span id="vaterror" class="error">We cannot verify this VAT number, this means you will have to pay VAT. Please make sure you\'ve entered the number correctly.</span>'),d=!1)})}var d=!1;jQuery(document).ready(function(a){var d=a("body");a("#card_number").payment("formatCardNumber"),a("#card-cvc").payment("formatCardCVC"),a(".chosen-select").chosen(),d.on("edd_cart_billing_address_updated",function(){a("#edd-card-state-wrap .chosen-container").remove(),a('select[name="card_state"]').chosen()}),a("#card_number").payment("formatCardNumber");a("#card_number").on("input",function(){a.payment.validateCardNumber(a(this).val())?a(this).removeClass("error").addClass("valid"):a(this).removeClass("valid").addClass("error"),""!=a("#card_cvc").val()&&(a.payment.validateCardCVC(a("#card_cvc").val(),a.payment.cardType(a(this).val()))?a("#card_cvc").removeClass("error").addClass("valid"):a("#card_cvc").removeClass("valid").addClass("error"))}),a("#card_cvc").on("input",function(){a.payment.validateCardCVC(a(this).val(),a.payment.cardType(a("#card_number").val()))?a(this).removeClass("error").addClass("valid"):a(this).removeClass("valid").addClass("error")}),a("#card_exp_year").on("input",function(){var b=a("#card_exp_month").val(),c=a(this).val();""!=b&&(a.payment.validateCardExpiry(b,c)?a("edd-input-cvc").removeClass("error").addClass("valid"):a("edd-input-cvc").removeClass("valid").addClass("error"))}),a("#edd_purchase_form").validate({unhighlight:function(b,c,d,e){"radio"===b.type?this.findByName(b.name).removeClass(c).addClass(d):a(b).hasClass("ignore")?a(b).removeClass(c).removeClass(d):a(b).removeClass(c).addClass(d)},errorClass:"error error-message",rules:{edd_email:{required:!0,email:!0},edd_first:"required",card_name:"required",card_address:{required:!0,minlength:2},card_city:{required:!0,minlength:2},card_zip:{required:!0,minlength:2},billing_country:"required",card_state:"required",edd_agree_to_terms:"required"},messages:{edd_first:"Please enter your first name",edd_email:"Please enter a valid email address",edd_agree_to_terms:"<strong>Error</strong> - Please accept our terms: ",card_name:"Please enter the name on your credit card",card_address:"Please enter the billing address of your credit card",card_zip:"Please enter the zip / postal code of the billing address of your credit card",card_state:"Please enter your state",card_city:"Please enter the city of the billing address of your credit card",billing_country:"Please enter the country of the billing address of your credit card"}}),a("body").on("change","#yst_btw, #billing_country",function(){b();var d=a("#billing_country").val();if("NL"==d)return a("#yst-edd-btw-wrap").hide().after('<p id="yst-dutch-vat-notice"><strong>Please note:</strong> VAT will be added to the invoice. Since Yoast is based in the Netherlands we cannot reverse charge the VAT.</p>'),void a(".edd_cart_tax_row").css("display","table-row");if(a("#yst-dutch-vat-notice").remove(),void 0==yoast_com_checkout_vars.tax_rates[d])return a("#yst-edd-btw-wrap").hide(),void a(".edd_cart_tax_row").css("display","none");a(".edd_cart_tax_row").css("display","table-row"),a("#yst-edd-btw-wrap").show();var e=a("#yst_btw").val();""!=e?c(d,e):b()})})}(jQuery);